<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>uav-mobility-app.tests.envs.test_NetworkEnv API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>uav-mobility-app.tests.envs.test_NetworkEnv</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import unittest
from uav_mobility_app.network_envs.envs.NetworkEnv import NetworkEnv
from uav_mobility_app.network_envs.entities.Network import Network
from uav_mobility_app.network_envs.entities.NetworkNode import NetworkNode
from uav_mobility_app.network_envs.entities.NetworkDevice import NetworkDevice
from uav_mobility_app.network_envs.entities.NetworkLink import NetworkLink
from uav_mobility_app.network_envs.enums.NetworkNodeType import NetworkNodeType
from uav_mobility_app.network_envs.enums.NetworkDeviceType import NetworkDeviceType
from uav_mobility_app.network_envs.entities.ExtendedNetworkLink import ExtendedNetworkLink
from gymnasium.spaces import Space
import numpy as np
from pathlib import Path


class test_NetworkEnv(unittest.TestCase):


    def test_initialization(self):
        &#34;&#34;&#34;Test that the NetworkEnv is initialized as expected when
        network_00.json is the environment used.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        obs_space: Space = net_env.get_wrapper_attr(&#34;observation_space&#34;)
        action_space: Space = net_env.get_wrapper_attr(&#34;action_space&#34;)
        self.assertEqual(obs_space.shape[0], n_actions * 3)
        self.assertEqual(action_space.n, n_actions)
        self.assertEqual(net_env.get_wrapper_attr(&#34;_dev&#34;), None)
        self.assertEqual(len(net_env.get_wrapper_attr(&#34;_path&#34;)), 0)

    def test_reset(self):
        &#34;&#34;&#34;Test that when reset is called all links are
        empty, their resources are free, all Devices, except the
        selected one, are inactive and that the observation obtained is
        consistent to the available links for the selected
        NetworkDevice.&#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        obs, _ = net_env.reset(seed=None, options=None)
        max_c: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[0]
        max_l: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[1]
        min_t: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).low[2]
        self.assertGreater(max_c, obs[0][0])
        self.assertGreater(max_l, obs[0][1])
        self.assertGreater(obs[0][2], min_t)
        for option in obs[1:]:
            self.assertEqual(max_c, option[0])
            self.assertEqual(max_l, option[1])
            self.assertEqual(min_t, option[2])
        for l in net_env._network.network_links:
            self.assertEqual(l.available_throughput, l.max_throughput)
            self.assertEqual(len(l.routed_flows), 0)
        selected_dev: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
        self.assertTrue(selected_dev.is_active)
        for d in set(net_env._network.network_devices) - set([selected_dev]):
            self.assertFalse(d.is_active)

    def test_hard_reset(self):
        &#34;&#34;&#34;Test that when the reset function is called enough times, the
        hard reset is triggered, the Network is cleared, i.e., the
        NetworkDevices&#39; paths are deallocated, they are set to inactive
        and all NetworkLinks&#39; resources are freed.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        hard_reset_period = 5
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             hard_reset_period= hard_reset_period,
                             render_mode=None)
        for i in range(hard_reset_period - 1):
            net_env.reset()
            terminated = False
            while (not terminated):
                obs, reward, terminated, _, _ = net_env.step(0)
            network_link_path: list[NetworkLink] = []
            device: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
            self.assertTrue(device.is_active)
            for l in net_env.get_wrapper_attr(&#34;_path&#34;):
                link: NetworkLink = l[2][&#34;data&#34;]
            for l in net_env.get_wrapper_attr(&#34;_path&#34;):
                link: NetworkLink = l[2][&#34;data&#34;]
                self.assertGreater(link.max_throughput, link.available_throughput)
                network_link_path.append(link)
        net_env.reset()
        device = net_env.get_wrapper_attr(&#34;_dev&#34;)
        self.assertTrue(device.is_active)
        for dev in set(net_env._network.network_devices) - set([device]):
            self.assertFalse(dev.is_active)
        for l in network_link_path:
            self.assertEqual(link.max_throughput, link.available_throughput)
            self.assertEqual(len(l.routed_flows), 0)


    def test_step(self):
        &#34;&#34;&#34;Test that a step is consistent. That is, the chosen
        NetworkLink is added to the self._path list and that the return
        values are correct: reward 0 if the state is not terminal and x
        otherwise, the observation represents the link of the selected
        NetworkLink. The info is a empty dict for the time being.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        net_env.reset()
        device: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
        network_link_path = net_env.get_wrapper_attr(&#34;_path&#34;)
        terminated = False
        expected_links: int = 1
        self.assertEqual(len(network_link_path), expected_links)
        expected_links += 1
        while (not terminated):
            _, _, terminated, _, _ = net_env.step(0)
            self.assertEqual(len(network_link_path), expected_links)
            expected_links += 1


    def test_step_padded_action(self):
        &#34;&#34;&#34;Test that when a &#34;false&#34; padded link is chosen as an action,
        no NetworkLink is added to the self._path list.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        net_env.reset()
        device: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
        network_link_path = net_env.get_wrapper_attr(&#34;_path&#34;)
        terminated = False
        expected_links: int = 1
        self.assertEqual(len(network_link_path), expected_links)
        n_actions: int = net_env.get_wrapper_attr(&#34;action_space&#34;).n
        for i in range(5):
            net_env.step(n_actions-1)
            self.assertEqual(len(network_link_path), expected_links)
        _, _, terminated, _, _ = net_env.step(0)
        expected_links += 1
        self.assertEqual(len(network_link_path), expected_links)
        for i in range(5):
            net_env.step(n_actions-1)

            self.assertEqual(len(network_link_path), expected_links)

    def test_obs(self):
        &#34;&#34;&#34;Test that the observations are consistent with the subyacent
        Network instance and that if there are less than self._actions
        available NetworkLinks, the remaining ones are padded with fake
        links.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        uav: NetworkDevice =  list(filter(
            lambda u: u.name == &#34;uav_00&#34;,
            net_env._network.uavs))[0]
        net_env._dev = uav
        link= list(net_env._network.out_edges(net_env._dev, data=True))[0]
        net_env._path.append(link)
        max_c: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[0]
        max_l: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[1]
        min_t: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).low[2]
        obs = net_env._get_obs()
        self.assertEqual(len(obs), n_actions)
        self.assertGreater(max_c, obs[0][0])
        self.assertGreater(max_l, obs[0][1])
        self.assertGreater(obs[0][2], min_t)
        for option in obs[1:]:
            self.assertEqual(max_c, option[0])
            self.assertEqual(max_l, option[1])
            self.assertEqual(min_t, option[2])

    def test_get_next_links(self):
        &#34;&#34;&#34;Check that the adjacent NetworkLinks to a given NetworkNode
        that lead to the NetworkNode of NetworkNodeType.GW are returned.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        link: ExtendedNetworkLink = list(filter(
            lambda l: l[2][&#34;data&#34;].id == 119,
            list(net_env._network.edges(data=True))))[0]
        net_env._path.append(link)
        next_links: list[ExtendedNetworkLink] = net_env._get_next_links()
        link_0: ExtendedNetworkLink = list(filter(
            lambda l: l[2][&#34;data&#34;].id == 107,
            list(net_env._network.edges(data=True))))[0]
        link_1: ExtendedNetworkLink = list(filter(
            lambda l: l[2][&#34;data&#34;].id == 110,
            list(net_env._network.edges(data=True))))[0]
        self.assertEqual(link_0, next_links[0])
        self.assertEqual(link_1, next_links[1])
        self.assertEqual((0, 0, 0), next_links[2])
        self.assertEqual((0, 0, 0), next_links[3])
        self.assertEqual((0, 0, 0), next_links[4])</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv"><code class="flex name class">
<span>class <span class="ident">test_NetworkEnv</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<div class="desc"><p>A class whose instances are single test cases.</p>
<p>By default, the test code itself should be placed in a method named
'runTest'.</p>
<p>If the fixture may be used for many test cases, create as
many test methods as are needed. When instantiating such a TestCase
subclass, specify in the constructor arguments the name of the test method
that the instance is to execute.</p>
<p>Test authors should subclass TestCase for their own tests. Construction
and deconstruction of the test's environment ('fixture') can be
implemented by overriding the 'setUp' and 'tearDown' methods respectively.</p>
<p>If it is necessary to override the <strong>init</strong> method, the base class
<strong>init</strong> method must always be called. It is important that subclasses
should not change the signature of their <strong>init</strong> method, since instances
of the classes are instantiated automatically by parts of the framework
in order to be run.</p>
<p>When subclassing TestCase, you can set these attributes:
* failureException: determines which exception will be raised when
the instance's assertion methods fail; test methods raising this
exception will be deemed to have 'failed' rather than 'errored'.
* longMessage: determines whether long messages (including repr of
objects used in assert methods) will be printed on failure in <em>addition</em>
to any explicit message passed.
* maxDiff: sets the maximum length of a diff in failure messages
by assert methods using difflib. It is looked up as an instance
attribute so can be configured by individual tests if required.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class test_NetworkEnv(unittest.TestCase):


    def test_initialization(self):
        &#34;&#34;&#34;Test that the NetworkEnv is initialized as expected when
        network_00.json is the environment used.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        obs_space: Space = net_env.get_wrapper_attr(&#34;observation_space&#34;)
        action_space: Space = net_env.get_wrapper_attr(&#34;action_space&#34;)
        self.assertEqual(obs_space.shape[0], n_actions * 3)
        self.assertEqual(action_space.n, n_actions)
        self.assertEqual(net_env.get_wrapper_attr(&#34;_dev&#34;), None)
        self.assertEqual(len(net_env.get_wrapper_attr(&#34;_path&#34;)), 0)

    def test_reset(self):
        &#34;&#34;&#34;Test that when reset is called all links are
        empty, their resources are free, all Devices, except the
        selected one, are inactive and that the observation obtained is
        consistent to the available links for the selected
        NetworkDevice.&#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        obs, _ = net_env.reset(seed=None, options=None)
        max_c: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[0]
        max_l: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[1]
        min_t: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).low[2]
        self.assertGreater(max_c, obs[0][0])
        self.assertGreater(max_l, obs[0][1])
        self.assertGreater(obs[0][2], min_t)
        for option in obs[1:]:
            self.assertEqual(max_c, option[0])
            self.assertEqual(max_l, option[1])
            self.assertEqual(min_t, option[2])
        for l in net_env._network.network_links:
            self.assertEqual(l.available_throughput, l.max_throughput)
            self.assertEqual(len(l.routed_flows), 0)
        selected_dev: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
        self.assertTrue(selected_dev.is_active)
        for d in set(net_env._network.network_devices) - set([selected_dev]):
            self.assertFalse(d.is_active)

    def test_hard_reset(self):
        &#34;&#34;&#34;Test that when the reset function is called enough times, the
        hard reset is triggered, the Network is cleared, i.e., the
        NetworkDevices&#39; paths are deallocated, they are set to inactive
        and all NetworkLinks&#39; resources are freed.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        hard_reset_period = 5
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             hard_reset_period= hard_reset_period,
                             render_mode=None)
        for i in range(hard_reset_period - 1):
            net_env.reset()
            terminated = False
            while (not terminated):
                obs, reward, terminated, _, _ = net_env.step(0)
            network_link_path: list[NetworkLink] = []
            device: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
            self.assertTrue(device.is_active)
            for l in net_env.get_wrapper_attr(&#34;_path&#34;):
                link: NetworkLink = l[2][&#34;data&#34;]
            for l in net_env.get_wrapper_attr(&#34;_path&#34;):
                link: NetworkLink = l[2][&#34;data&#34;]
                self.assertGreater(link.max_throughput, link.available_throughput)
                network_link_path.append(link)
        net_env.reset()
        device = net_env.get_wrapper_attr(&#34;_dev&#34;)
        self.assertTrue(device.is_active)
        for dev in set(net_env._network.network_devices) - set([device]):
            self.assertFalse(dev.is_active)
        for l in network_link_path:
            self.assertEqual(link.max_throughput, link.available_throughput)
            self.assertEqual(len(l.routed_flows), 0)


    def test_step(self):
        &#34;&#34;&#34;Test that a step is consistent. That is, the chosen
        NetworkLink is added to the self._path list and that the return
        values are correct: reward 0 if the state is not terminal and x
        otherwise, the observation represents the link of the selected
        NetworkLink. The info is a empty dict for the time being.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        net_env.reset()
        device: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
        network_link_path = net_env.get_wrapper_attr(&#34;_path&#34;)
        terminated = False
        expected_links: int = 1
        self.assertEqual(len(network_link_path), expected_links)
        expected_links += 1
        while (not terminated):
            _, _, terminated, _, _ = net_env.step(0)
            self.assertEqual(len(network_link_path), expected_links)
            expected_links += 1


    def test_step_padded_action(self):
        &#34;&#34;&#34;Test that when a &#34;false&#34; padded link is chosen as an action,
        no NetworkLink is added to the self._path list.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        net_env.reset()
        device: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
        network_link_path = net_env.get_wrapper_attr(&#34;_path&#34;)
        terminated = False
        expected_links: int = 1
        self.assertEqual(len(network_link_path), expected_links)
        n_actions: int = net_env.get_wrapper_attr(&#34;action_space&#34;).n
        for i in range(5):
            net_env.step(n_actions-1)
            self.assertEqual(len(network_link_path), expected_links)
        _, _, terminated, _, _ = net_env.step(0)
        expected_links += 1
        self.assertEqual(len(network_link_path), expected_links)
        for i in range(5):
            net_env.step(n_actions-1)

            self.assertEqual(len(network_link_path), expected_links)

    def test_obs(self):
        &#34;&#34;&#34;Test that the observations are consistent with the subyacent
        Network instance and that if there are less than self._actions
        available NetworkLinks, the remaining ones are padded with fake
        links.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        uav: NetworkDevice =  list(filter(
            lambda u: u.name == &#34;uav_00&#34;,
            net_env._network.uavs))[0]
        net_env._dev = uav
        link= list(net_env._network.out_edges(net_env._dev, data=True))[0]
        net_env._path.append(link)
        max_c: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[0]
        max_l: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[1]
        min_t: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).low[2]
        obs = net_env._get_obs()
        self.assertEqual(len(obs), n_actions)
        self.assertGreater(max_c, obs[0][0])
        self.assertGreater(max_l, obs[0][1])
        self.assertGreater(obs[0][2], min_t)
        for option in obs[1:]:
            self.assertEqual(max_c, option[0])
            self.assertEqual(max_l, option[1])
            self.assertEqual(min_t, option[2])

    def test_get_next_links(self):
        &#34;&#34;&#34;Check that the adjacent NetworkLinks to a given NetworkNode
        that lead to the NetworkNode of NetworkNodeType.GW are returned.
        &#34;&#34;&#34;
        n_actions = 5
        configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
        net_env = NetworkEnv(configuration=configuration,
                             n_actions=n_actions,
                             render_mode=None)
        link: ExtendedNetworkLink = list(filter(
            lambda l: l[2][&#34;data&#34;].id == 119,
            list(net_env._network.edges(data=True))))[0]
        net_env._path.append(link)
        next_links: list[ExtendedNetworkLink] = net_env._get_next_links()
        link_0: ExtendedNetworkLink = list(filter(
            lambda l: l[2][&#34;data&#34;].id == 107,
            list(net_env._network.edges(data=True))))[0]
        link_1: ExtendedNetworkLink = list(filter(
            lambda l: l[2][&#34;data&#34;].id == 110,
            list(net_env._network.edges(data=True))))[0]
        self.assertEqual(link_0, next_links[0])
        self.assertEqual(link_1, next_links[1])
        self.assertEqual((0, 0, 0), next_links[2])
        self.assertEqual((0, 0, 0), next_links[3])
        self.assertEqual((0, 0, 0), next_links[4])</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_get_next_links"><code class="name flex">
<span>def <span class="ident">test_get_next_links</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Check that the adjacent NetworkLinks to a given NetworkNode
that lead to the NetworkNode of NetworkNodeType.GW are returned.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_get_next_links(self):
    &#34;&#34;&#34;Check that the adjacent NetworkLinks to a given NetworkNode
    that lead to the NetworkNode of NetworkNodeType.GW are returned.
    &#34;&#34;&#34;
    n_actions = 5
    configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
    net_env = NetworkEnv(configuration=configuration,
                         n_actions=n_actions,
                         render_mode=None)
    link: ExtendedNetworkLink = list(filter(
        lambda l: l[2][&#34;data&#34;].id == 119,
        list(net_env._network.edges(data=True))))[0]
    net_env._path.append(link)
    next_links: list[ExtendedNetworkLink] = net_env._get_next_links()
    link_0: ExtendedNetworkLink = list(filter(
        lambda l: l[2][&#34;data&#34;].id == 107,
        list(net_env._network.edges(data=True))))[0]
    link_1: ExtendedNetworkLink = list(filter(
        lambda l: l[2][&#34;data&#34;].id == 110,
        list(net_env._network.edges(data=True))))[0]
    self.assertEqual(link_0, next_links[0])
    self.assertEqual(link_1, next_links[1])
    self.assertEqual((0, 0, 0), next_links[2])
    self.assertEqual((0, 0, 0), next_links[3])
    self.assertEqual((0, 0, 0), next_links[4])</code></pre>
</details>
</dd>
<dt id="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_hard_reset"><code class="name flex">
<span>def <span class="ident">test_hard_reset</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Test that when the reset function is called enough times, the
hard reset is triggered, the Network is cleared, i.e., the
NetworkDevices' paths are deallocated, they are set to inactive
and all NetworkLinks' resources are freed.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_hard_reset(self):
    &#34;&#34;&#34;Test that when the reset function is called enough times, the
    hard reset is triggered, the Network is cleared, i.e., the
    NetworkDevices&#39; paths are deallocated, they are set to inactive
    and all NetworkLinks&#39; resources are freed.
    &#34;&#34;&#34;
    n_actions = 5
    configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
    hard_reset_period = 5
    net_env = NetworkEnv(configuration=configuration,
                         n_actions=n_actions,
                         hard_reset_period= hard_reset_period,
                         render_mode=None)
    for i in range(hard_reset_period - 1):
        net_env.reset()
        terminated = False
        while (not terminated):
            obs, reward, terminated, _, _ = net_env.step(0)
        network_link_path: list[NetworkLink] = []
        device: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
        self.assertTrue(device.is_active)
        for l in net_env.get_wrapper_attr(&#34;_path&#34;):
            link: NetworkLink = l[2][&#34;data&#34;]
        for l in net_env.get_wrapper_attr(&#34;_path&#34;):
            link: NetworkLink = l[2][&#34;data&#34;]
            self.assertGreater(link.max_throughput, link.available_throughput)
            network_link_path.append(link)
    net_env.reset()
    device = net_env.get_wrapper_attr(&#34;_dev&#34;)
    self.assertTrue(device.is_active)
    for dev in set(net_env._network.network_devices) - set([device]):
        self.assertFalse(dev.is_active)
    for l in network_link_path:
        self.assertEqual(link.max_throughput, link.available_throughput)
        self.assertEqual(len(l.routed_flows), 0)</code></pre>
</details>
</dd>
<dt id="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_initialization"><code class="name flex">
<span>def <span class="ident">test_initialization</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Test that the NetworkEnv is initialized as expected when
network_00.json is the environment used.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_initialization(self):
    &#34;&#34;&#34;Test that the NetworkEnv is initialized as expected when
    network_00.json is the environment used.
    &#34;&#34;&#34;
    n_actions = 5
    configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
    net_env = NetworkEnv(configuration=configuration,
                         n_actions=n_actions,
                         render_mode=None)
    obs_space: Space = net_env.get_wrapper_attr(&#34;observation_space&#34;)
    action_space: Space = net_env.get_wrapper_attr(&#34;action_space&#34;)
    self.assertEqual(obs_space.shape[0], n_actions * 3)
    self.assertEqual(action_space.n, n_actions)
    self.assertEqual(net_env.get_wrapper_attr(&#34;_dev&#34;), None)
    self.assertEqual(len(net_env.get_wrapper_attr(&#34;_path&#34;)), 0)</code></pre>
</details>
</dd>
<dt id="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_obs"><code class="name flex">
<span>def <span class="ident">test_obs</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Test that the observations are consistent with the subyacent
Network instance and that if there are less than self._actions
available NetworkLinks, the remaining ones are padded with fake
links.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs(self):
    &#34;&#34;&#34;Test that the observations are consistent with the subyacent
    Network instance and that if there are less than self._actions
    available NetworkLinks, the remaining ones are padded with fake
    links.
    &#34;&#34;&#34;
    n_actions = 5
    configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
    net_env = NetworkEnv(configuration=configuration,
                         n_actions=n_actions,
                         render_mode=None)
    uav: NetworkDevice =  list(filter(
        lambda u: u.name == &#34;uav_00&#34;,
        net_env._network.uavs))[0]
    net_env._dev = uav
    link= list(net_env._network.out_edges(net_env._dev, data=True))[0]
    net_env._path.append(link)
    max_c: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[0]
    max_l: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[1]
    min_t: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).low[2]
    obs = net_env._get_obs()
    self.assertEqual(len(obs), n_actions)
    self.assertGreater(max_c, obs[0][0])
    self.assertGreater(max_l, obs[0][1])
    self.assertGreater(obs[0][2], min_t)
    for option in obs[1:]:
        self.assertEqual(max_c, option[0])
        self.assertEqual(max_l, option[1])
        self.assertEqual(min_t, option[2])</code></pre>
</details>
</dd>
<dt id="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_reset"><code class="name flex">
<span>def <span class="ident">test_reset</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Test that when reset is called all links are
empty, their resources are free, all Devices, except the
selected one, are inactive and that the observation obtained is
consistent to the available links for the selected
NetworkDevice.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_reset(self):
    &#34;&#34;&#34;Test that when reset is called all links are
    empty, their resources are free, all Devices, except the
    selected one, are inactive and that the observation obtained is
    consistent to the available links for the selected
    NetworkDevice.&#34;&#34;&#34;
    n_actions = 5
    configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
    net_env = NetworkEnv(configuration=configuration,
                         n_actions=n_actions,
                         render_mode=None)
    obs, _ = net_env.reset(seed=None, options=None)
    max_c: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[0]
    max_l: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).high[1]
    min_t: float = net_env.get_wrapper_attr(&#34;_obs_space&#34;).low[2]
    self.assertGreater(max_c, obs[0][0])
    self.assertGreater(max_l, obs[0][1])
    self.assertGreater(obs[0][2], min_t)
    for option in obs[1:]:
        self.assertEqual(max_c, option[0])
        self.assertEqual(max_l, option[1])
        self.assertEqual(min_t, option[2])
    for l in net_env._network.network_links:
        self.assertEqual(l.available_throughput, l.max_throughput)
        self.assertEqual(len(l.routed_flows), 0)
    selected_dev: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
    self.assertTrue(selected_dev.is_active)
    for d in set(net_env._network.network_devices) - set([selected_dev]):
        self.assertFalse(d.is_active)</code></pre>
</details>
</dd>
<dt id="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_step"><code class="name flex">
<span>def <span class="ident">test_step</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Test that a step is consistent. That is, the chosen
NetworkLink is added to the self._path list and that the return
values are correct: reward 0 if the state is not terminal and x
otherwise, the observation represents the link of the selected
NetworkLink. The info is a empty dict for the time being.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_step(self):
    &#34;&#34;&#34;Test that a step is consistent. That is, the chosen
    NetworkLink is added to the self._path list and that the return
    values are correct: reward 0 if the state is not terminal and x
    otherwise, the observation represents the link of the selected
    NetworkLink. The info is a empty dict for the time being.
    &#34;&#34;&#34;
    n_actions = 5
    configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
    net_env = NetworkEnv(configuration=configuration,
                         n_actions=n_actions,
                         render_mode=None)
    net_env.reset()
    device: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
    network_link_path = net_env.get_wrapper_attr(&#34;_path&#34;)
    terminated = False
    expected_links: int = 1
    self.assertEqual(len(network_link_path), expected_links)
    expected_links += 1
    while (not terminated):
        _, _, terminated, _, _ = net_env.step(0)
        self.assertEqual(len(network_link_path), expected_links)
        expected_links += 1</code></pre>
</details>
</dd>
<dt id="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_step_padded_action"><code class="name flex">
<span>def <span class="ident">test_step_padded_action</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Test that when a "false" padded link is chosen as an action,
no NetworkLink is added to the self._path list.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_step_padded_action(self):
    &#34;&#34;&#34;Test that when a &#34;false&#34; padded link is chosen as an action,
    no NetworkLink is added to the self._path list.
    &#34;&#34;&#34;
    n_actions = 5
    configuration: Path = Path.cwd().joinpath(&#34;input&#34;, &#34;network_00.json&#34;)
    net_env = NetworkEnv(configuration=configuration,
                         n_actions=n_actions,
                         render_mode=None)
    net_env.reset()
    device: NetworkDevice = net_env.get_wrapper_attr(&#34;_dev&#34;)
    network_link_path = net_env.get_wrapper_attr(&#34;_path&#34;)
    terminated = False
    expected_links: int = 1
    self.assertEqual(len(network_link_path), expected_links)
    n_actions: int = net_env.get_wrapper_attr(&#34;action_space&#34;).n
    for i in range(5):
        net_env.step(n_actions-1)
        self.assertEqual(len(network_link_path), expected_links)
    _, _, terminated, _, _ = net_env.step(0)
    expected_links += 1
    self.assertEqual(len(network_link_path), expected_links)
    for i in range(5):
        net_env.step(n_actions-1)

        self.assertEqual(len(network_link_path), expected_links)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="uav-mobility-app.tests.envs" href="index.html">uav-mobility-app.tests.envs</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv" href="#uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv">test_NetworkEnv</a></code></h4>
<ul class="">
<li><code><a title="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_get_next_links" href="#uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_get_next_links">test_get_next_links</a></code></li>
<li><code><a title="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_hard_reset" href="#uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_hard_reset">test_hard_reset</a></code></li>
<li><code><a title="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_initialization" href="#uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_initialization">test_initialization</a></code></li>
<li><code><a title="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_obs" href="#uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_obs">test_obs</a></code></li>
<li><code><a title="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_reset" href="#uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_reset">test_reset</a></code></li>
<li><code><a title="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_step" href="#uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_step">test_step</a></code></li>
<li><code><a title="uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_step_padded_action" href="#uav-mobility-app.tests.envs.test_NetworkEnv.test_NetworkEnv.test_step_padded_action">test_step_padded_action</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>